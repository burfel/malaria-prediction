# #
# # fit.c = lm(outcome ~ Percentage.parasitemia, data=dat)
# # summary(fit.c) # R^2 = 0.26
# # fit.d = lm(outcome ~ Hemoglobin.concentration..g.dL., data=dat)
# # summary(fit.d) # R^2 = 0.26
# # summary(fit.w) # R^2 = 0.06
# #
# # fit.cd = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL., data=dat)
# # summary(fit.cd) # R^2 = 0.35
# # fit.cw = lm(outcome ~ Percentage.parasitemia + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# #
# # fit.cd = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL., data=dat)
# # summary(fit.cd) # R^2 = 0.35
# # fit.cw = lm(outcome ~ Percentage.parasitemia + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# # fit.w = lm(outcome ~ Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.w) # R^2 = 0.06
# #
# # fit.cd = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL., data=dat)
# # summary(fit.cd) # R^2 = 0.35
# # fit.cw = lm(outcome ~ Percentage.parasitemia + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cd = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL., data=dat)
# # summary(fit.cd) # R^2 = 0.35
# # fit.cw = lm(outcome ~ Percentage.parasitemia + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # summary(fit.cd) # R^2 = 0.35
# # fit.cw = lm(outcome ~ Percentage.parasitemia + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.cw = lm(outcome ~ Percentage.parasitemia + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.p = lm(outcome ~ Parasite.clones, data=dat)
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.p = lm(outcome ~ Parasite.clones, data=dat)
# # summary(fit.p) # R^2 = 0.086
# # fit.pc = lm(outcome ~ Percentage.parasitemia + Parasite.clones, data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.p = lm(outcome ~ Parasite.clones, data=dat)
# # summary(fit.p) # R^2 = 0.086
# # fit.pc = lm(outcome ~ Percentage.parasitemia + Parasite.clones, data=dat)
# # summary(fit.pc) # R^2 = 0.43
# # summary(fit.d) # R^2 = 0.26
# # fit.w = lm(outcome ~ Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.w) # R^2 = 0.06
# #
# # fit.cd = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL., data=dat)
# # summary(fit.cd) # R^2 = 0.35
# # fit.cw = lm(outcome ~ Percentage.parasitemia + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.p = lm(outcome ~ Parasite.clones, data=dat)
# # summary(fit.p) # R^2 = 0.086
# # fit.pc = lm(outcome ~ Percentage.parasitemia + Parasite.clones, data=dat)
# # summary(fit.pc) # R^2 = 0.43
# # fit.pw = lm(outcome ~ Parasite.clones + Total.White.Cell.Count..x109.L., data=dat)
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.p = lm(outcome ~ Parasite.clones, data=dat)
# # summary(fit.p) # R^2 = 0.086
# # fit.pc = lm(outcome ~ Percentage.parasitemia + Parasite.clones, data=dat)
# # summary(fit.pc) # R^2 = 0.43
# # fit.pw = lm(outcome ~ Parasite.clones + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.pw) # R^2 = 0.158
# # summary(fit.cw) # R^2 = 0.30
# # fit.dw = lm(outcome ~ Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.dw) # R^2 = 0.078
# #
# # fit.cdw = lm(outcome ~ Percentage.parasitemia + Hemoglobin.concentration..g.dL. + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.p = lm(outcome ~ Parasite.clones, data=dat)
# # summary(fit.p) # R^2 = 0.086
# # summary(fit.cdw) # R^2 = 0.37
# #
# # # with parasite clones instead of hemoglobin concentration
# # fit.p = lm(outcome ~ Parasite.clones, data=dat)
# # summary(fit.p) # R^2 = 0.086
# # fit.pc = lm(outcome ~ Percentage.parasitemia + Parasite.clones, data=dat)
# # summary(fit.pc) # R^2 = 0.43
# # fit.pw = lm(outcome ~ Parasite.clones + Total.White.Cell.Count..x109.L., data=dat)
# # summary(fit.pw) # R^2 = 0.158
# #
runApp()
save(outcome_prop, file = "../shinyapp4/Rdata/outcome_prop.rda")
save(outcome_prop.nc.nona, file = "../shinyapp4/Rdata/outcome_prop_nc_nona.rda")
save(outcome_prop.nona, file = "../shinyapp4/Rdata/outcome_prop_nona.rda")
runApp()
runApp()
model.rq <- rq(dat.nc.nona$outcome ~ dat.nc.nona$Percentage.parasitemia * dat.nc.nona$Total.White.Cell.Count..x109.L., tau=c(0.25, 0.5, 0.75))
quantile.regressions <- data.frame(t(coef(model.rq)))
colnames(quantile.regressions) <- c("intercept", "slope")
quantile.regressions$quantile <- rownames(quantile.regressions)
quantile.regressions
library(ggplot2)
scatterplot <- qplot(x=Percentage.parasitemia, y=outcome, data=dat.nc.nona)
scatterplot + geom_abline(aes(intercept=intercept, slope=slope,
colour=quantile), data=quantile.regressions)
scatterplot1 <- qplot(x=Percentage.parasitemia, y=outcome, data=dat.nona)
scatterplot1
scatterplot <- qplot(x=Percentage.parasitemia, y=outcome, data=dat.nc.nona)
scatterplot + geom_abline(aes(intercept=intercept, slope=slope,
colour=quantile), data=quantile.regressions)
scatterplot1 <- qplot(x=Percentage.parasitemia, y=outcome, data=dat.nona)
library(quantreg)
model.rq <- rq(dat.nc.nona$outcome ~ dat.nc.nona$Percentage.parasitemia * dat.nc.nona$Total.White.Cell.Count..x109.L., tau=c(0.25, 0.5, 0.75))
quantile.regressions <- data.frame(t(coef(model.rq)))
colnames(quantile.regressions) <- c("intercept", "slope")
quantile.regressions$quantile <- rownames(quantile.regressions)
quantile.regressions
library(ggplot2)
scatterplot <- qplot(x=Percentage.parasitemia, y=outcome, data=dat.nc.nona)
scatterplot + geom_abline(aes(intercept=intercept, slope=slope,
colour=quantile), data=quantile.regressions)
scatterplot1 <- qplot(x=Percentage.parasitemia, y=outcome, data=dat.nona)
scatterplot1
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome), color=cyl) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,100)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point() +
geom_smooth(method="lm", se=F) +
geom_point(color='darkred') +
geom_smooth(data = dat.nc.nona[c(7,10,11,19),], method="lm", se=F, color="darkred", linetype = "dashed") +
scale_colour_manual(name="lines", values=c("red", "blue"))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "green")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "green", "orange")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,1,2,3,4,5,6,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "green", "orange")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[c(7,10,1,2,3,4,5,6,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "green", "orange")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[c(7),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "green", "orange")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[c(7,10,11),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "green", "orange")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "green")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19,35,39),], aes(colour="linear model without potential outliers 7,10,11,19,35,39"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
#geom_smooth(data = dat.nc.nona[-c(7,10,11,19,35,39),], aes(colour="linear model without potential outliers 7,10,11,19,35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
#geom_smooth(data = dat.nc.nona[-c(7,10,11,19,35,39),], aes(colour="linear model without potential outliers 7,10,11,19,35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(35,36),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[c(35,36),], aes(colour="linear model without potential outliers 7,10,11,19,35,39"), method="lm", se=F, linetype = "dashed") +
#geom_smooth(data = dat.nc.nona[c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
View(dat.nc.nona)
View(dat.nc.nona)
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#png("../shinyapp4/img/both_paras_regr_better_outlier.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(29,33),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14,29,33),], aes(colour="linear model without potential outliers 7,10,11,19,35,39"), method="lm", se=F, linetype = "dashed") +
#geom_smooth(data = dat.nc.nona[c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
png("../shinyapp4/img/both_paras_regr_better_outlier_4.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(29,33),], aes(colour="linear model without potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14,29,33),], aes(colour="linear model without potential outliers 7,10,11,19,35,39"), method="lm", se=F, linetype = "dashed") +
#geom_smooth(data = dat.nc.nona[c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
dev.off()
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(29,33),], aes(colour="linear model w/o \n potential outliers 35,39"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14),], aes(colour="linear model w/o \n potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14,29,33),], aes(colour="linear model w/o \n potential outliers 7,10,11,19,35,39"), method="lm", se=F, linetype = "dashed") +
#geom_smooth(data = dat.nc.nona[c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
###################----PLOTS--------!!!!!!!!!!!!!!!!!!!!!!!!!!!!
png("../shinyapp4/img/both_paras_regr_better_outlier_4.png")
ggplot(dat.nc.nona, aes(Percentage.parasitemia, outcome)) +
scale_x_continuous(name="Percentage of parasitemia", limits=c(0,50)) +  ## -- with it pdenstiy does not show up
scale_y_continuous(name="Percentage of reads mapping to pathogen", limits=c(0,1)) +
geom_text(label=rownames(dat.nc.nona)) +
geom_point(colour="dodgerblue",alpha=0.75) +
geom_abline(aes(colour="linear model on complete \n samples (21) \n", intercept=0.090267, slope=0.013339), alpha=1, size=1) +
geom_smooth(aes(colour="linear model on samples that complete \n after variable selection (40) \n"), method = "lm", linetype="dashed", se=FALSE) +
geom_smooth(data = dat.nc.nona[-c(29,33),], aes(colour="linear model w/o \n potential outliers 35,39 \n"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14),], aes(colour="linear model w/o \n potential outliers 7,10,11,19 \n"), method="lm", se=F, linetype = "dashed") +
geom_smooth(data = dat.nc.nona[-c(5,8,9,14,29,33),], aes(colour="linear model w/o \n potential outliers 7,10,11,19,35,39 \n"), method="lm", se=F, linetype = "dashed") +
#geom_smooth(data = dat.nc.nona[c(7,10,11,19),], aes(colour="linear model without potential outliers 7,10,11,19 \n"), method="lm", se=F, linetype = "dashed") +
scale_colour_manual(name="Linear regression lines \n", values=c("red", "blue", "orange", "green", "brown")) +
guides(colour = guide_legend(override.aes = list(alpha = 0))) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14,face="bold")) +
theme(plot.title = element_text(size = 12, face = "bold"),
legend.title=element_text(size=15),
legend.text=element_text(size=13))
dev.off()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runGitHub("malaria-prediction", "burfel", subdir="shinyapp4")
runApp()
View(dummy)
references <- summary_complex_dens <- read.csv("~/Documents/IMPERIAL/PROJECTS/project2/GITHUB/shinyapp4/Rdata/references.csv", header=TRUE)
references
references <- summary_complex_dens <- read.csv("~/Documents/IMPERIAL/PROJECTS/project2/GITHUB/shinyapp4/Rdata/references.csv", header=TRUE)
references
View(references)
references <- references[,1:2]
#===============================================================================
#                      SAVE MODELS                                             #
#===============================================================================
# save references R object
save(references, file = "../shinyapp4/Rdata/references.rda")
runApp()
